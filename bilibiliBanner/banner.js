const app=document.getElementById("app"),header=document.getElementById("page-header");!async function(){if(null===app)return;const t=Math.floor(10*Math.random()+1),e=await fetch(`/bilibiliBanner/images/${t}/data.json`),a=await e.json();let r=[],n=0;!function(){n=window.innerWidth/1530,app.style.display="none";for(let t=0;t<a.length;t++){const e=a[t],r=document.createElement("div");r.classList.add("layer");const s=document.createElement(e.tagName);"video"===e.tagName&&(s.loop=!0,s.autoplay=!0,s.muted=!0),s.src=e.src,s.style.width=e.width*n+"px",s.style.height=e.height*n+"px";let l=e.transform.translateX*n,i=e.transform.translateY*n,o=e.transform.rotate,d=e.transform.scale;s.style.transform=`translate(${l}px,${i}px) rotate(${o}deg) scale(${d})`,r.appendChild(s),app.appendChild(r)}app.style.display="",r=document.querySelectorAll("#app .layer")}();let s=0,l=0;header.addEventListener("mouseenter",(t=>{s=t.clientX,r.forEach((t=>{t.firstChild.style.transition=""}))})),lerp=(t,e,a)=>(1-a)*t+a*e,header.addEventListener("mousemove",(function(t){l=t.clientX-s,requestAnimationFrame((()=>{!function(t){if(r.length<=0)return;for(let e=0;e<r.length;e++){const s=a[e];let l=s.transform.translateX+t*(s.a||0),i=s.transform.scale+t*(s.f||0),o=s.transform.translateY+t*(s.g||0),d=s.transform.rotate+t*(s.r||0);r[e].firstChild.style.opacity=lerp(s.opacity[0],s.opacity[1],t/window.innerWidth*2),r[e].firstChild.style.transform=`translate(${l*n}px,${o*n}px) rotate(${d}deg) scale(${i})`}}(l)}))})),header.addEventListener("mouseleave",(function(){r.forEach(((t,e)=>{const r=t.firstChild,s=a[e];requestAnimationFrame((()=>{r.style.transition="all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",r.style.width=s.width*n+"px",r.style.height=s.height*n+"px";let t=s.transform.translateX*n,e=s.transform.translateY*n,a=s.transform.rotate,l=s.transform.scale;r.style.transform=`translate(${t}px,${e}px) rotate(${a}deg) scale(${l})`}))}))}));let i=null;window.addEventListener("resize",(()=>{clearTimeout(i),i=setTimeout((()=>{n=window.innerWidth>1650?window.innerWidth/1650:1,r.forEach(((t,e)=>{const r=t.firstChild,s=a[e];requestAnimationFrame((()=>{r.style.width=s.width*n+"px",r.style.height=s.height*n+"px";let t=s.transform.translateX*n,e=s.transform.translateY*n,a=s.transform.rotate,l=s.transform.scale;r.style.transform=`translate(${t*n}px,${e*n}px) rotate(${a}deg) scale(${l})`}))}))}),1e3)}))}();