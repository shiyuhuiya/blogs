const app=document.getElementById("app"),header=document.getElementById("page-header");!async function(){const t=Math.floor(10*Math.random()+1),e=await fetch(`/bilibiliBanner/images/${t}/data.json`),a=await e.json();let n=[],r=0;!function(){r=window.innerWidth>1650?window.innerWidth/1650:1,app.style.display="none";for(let t=0;t<a.length;t++){const e=a[t],n=document.createElement("div");n.classList.add("layer");const s=document.createElement(e.tagName);"video"===e.tagName&&(s.loop=!0,s.autoplay=!0,s.muted=!0),s.src=e.src,s.style.width=e.width*r+"px",s.style.height=e.height*r+"px";let o=e.transform.translateX*r,l=e.transform.translateY*r,i=e.transform.rotate,d=e.transform.scale;s.style.transform=`translate(${o}px,${l}px) rotate(${i}deg) scale(${d})`,n.appendChild(s),app.appendChild(n)}app.style.display="",n=document.querySelectorAll("#app .layer")}();let s=0,o=0;lerp=(t,e,a)=>(1-a)*t+a*e;let l=!1;header.addEventListener("mousemove",(function(t){l||(s=t.pageX,l=!0),requestAnimationFrame((()=>{o=t.pageX-s,function(){if(!(n.length<=0))for(let t=0;t<n.length;t++){const e=a[t];let r=e.transform.translateX+o*(e.a||0),s=e.transform.scale+(e.f||0)*o,l=e.transform.translateY+o*(e.g||0),i=e.transform.rotate+o*(e.r||0);n[t].firstChild.style.opacity=lerp(e.opacity[0],e.opacity[1],o/window.innerWidth*2),n[t].firstChild.style.transform=`translate(${r}px,${l}px) rotate(${i}deg) scale(${s})`}}()}))})),header.addEventListener("mouseleave",(function(){l=!1,n.forEach(((t,e)=>{const n=t.firstChild,s=a[e];n.addEventListener("transitionend",(()=>{n.style.transition=""}),{once:!0}),requestAnimationFrame((()=>{n.style.transition="all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",n.style.width=s.width*r+"px",n.style.height=s.height*r+"px";let t=s.transform.translateX*r,e=s.transform.translateY*r,a=s.transform.rotate,o=s.transform.scale;n.style.transform=`translate(${t}px,${e}px) rotate(${a}deg) scale(${o})`}))}))}))}();