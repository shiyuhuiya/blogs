const app=document.getElementById("app"),header=document.getElementById("page-header");!async function(){if(null===app)return;const t=Math.floor(10*Math.random()+1),e=await fetch(`/bilibiliBanner/images/${t}/data.json`),a=await e.json();let n=[],r=0;!function(){r=window.innerWidth>1650?window.innerWidth/1650:1,app.style.display="none";for(let t=0;t<a.length;t++){const e=a[t],n=document.createElement("div");n.classList.add("layer");const s=document.createElement(e.tagName);"video"===e.tagName&&(s.loop=!0,s.autoplay=!0,s.muted=!0),s.src=e.src,s.style.width=e.width*r+"px",s.style.height=e.height*r+"px";let l=e.transform.translateX*r,i=e.transform.translateY*r,o=e.transform.rotate,d=e.transform.scale;s.style.transform=`translate(${l}px,${i}px) rotate(${o}deg) scale(${d})`,n.appendChild(s),app.appendChild(n)}app.style.display="",n=document.querySelectorAll("#app .layer")}();let s=0,l=0;header.addEventListener("mouseenter",(t=>{s=t.clientX,n.forEach((t=>{t.firstChild.style.transition=""}))})),lerp=(t,e,a)=>(1-a)*t+a*e,header.addEventListener("mousemove",(function(t){l=t.clientX-s,requestAnimationFrame((()=>{!function(t){if(n.length<=0)return;for(let e=0;e<n.length;e++){const r=a[e];let s=r.transform.translateX+t*(r.a||0),l=r.transform.scale+(r.f||0)*t,i=r.transform.translateY+t*(r.g||0),o=r.transform.rotate+t*(r.r||0);n[e].firstChild.style.opacity=lerp(r.opacity[0],r.opacity[1],t/window.innerWidth*2),n[e].firstChild.style.transform=`translate(${s}px,${i}px) rotate(${o}deg) scale(${l})`}}(l)}))})),header.addEventListener("mouseleave",(function(){n.forEach(((t,e)=>{const n=t.firstChild,s=a[e];n.addEventListener("transitionend",(()=>{n.style.transition=""}),{once:!0}),requestAnimationFrame((()=>{n.style.transition="all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",n.style.width=s.width*r+"px",n.style.height=s.height*r+"px";let t=s.transform.translateX*r,e=s.transform.translateY*r,a=s.transform.rotate,l=s.transform.scale;n.style.transform=`translate(${t}px,${e}px) rotate(${a}deg) scale(${l})`}))}))}))}();